import pandas as pd
import numpy as np
from matplotlib import pyplot

from bokeh.io import curdoc
from bokeh.layouts import column,row
from bokeh.models import ColumnDataSource, CustomJS, RangeSlider,Slider,LogColorMapper
from bokeh.plotting import figure, show,output_file
from bokeh.palettes import Inferno256
import os
import sys 
sys.path.insert(1,"sample")
from smoother import w_e_smoother,mean_smooth
from coord_precessing import speed,turn
from output_read import read_excel


OUTPUT_PATH=os.path.join('E:','Stage_Tremplin','TRAJECTORy','resultat')


def load_cvs(source):
    return pd.read_csv(source)

 
def plot():


    sources_trajec=dict()

    print(os.listdir(OUTPUT_PATH)[1:])
    for rat in os.listdir(OUTPUT_PATH)[1:]:
        for exp in ['pre_lesion','48_h_postL','1_semaine_postL','3_semaine_postL']:
            

            if exp in os.listdir(os.path.join(OUTPUT_PATH,rat)):


            
                print(rat,exp)
                SAVE_PATH=os.path.join(OUTPUT_PATH,rat,exp)

                for i,name in enumerate(os.listdir(SAVE_PATH)):
                    #dataframe=get_csv(rat,exp,num=i)
                    #deb=start(dataframe)

                    dataframe=read_excel.get_csv_of(rat,exp,num=i)
                    x_clean,y_clean,t_clean=read_excel.clean(dataframe)
                    source = ColumnDataSource(data=dict(x=w_e_smoother.whittaker_smooth(x_clean), y=w_e_smoother.whittaker_smooth(y_clean)))
                    sources_trajec[rat+exp+str(i)]=source
                    pyplot.hist(read_excel.distance_bord(x_clean,y_clean),bins=100)
                    pyplot.show()
    print(sources_trajec.keys())
    #output_file(filename=output_filename+".html", title=title)

    curdoc().theme = "dark_minimal"




plot()
